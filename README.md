# "This Machine Kills Secret" Puzzle

![Book Cover](https://raw.github.com/alx/this_machine_kills_secrets/master/img/this-machine-kills-secrets-cover.png)

On this project, I'm trying to crowd-source the solution of the puzzle you can find inside Andy Greenberg new book: [This Machine Kills Secrets](http://www.thismachinekillssecrets.com/puzzle/)

You'll find:

* *secret.csv*: a csv format file containing the page number and the decrypted morse code
* *scripts/verify_code_on_page.rb*: a script to display the morse code that has been entered in *secret.csv* and verify it matches with the morse on the selected page
* *scripts/lrs.rb*: a script ot find longest repeated substring
* *scripts/double_dots.rb*: cut the full code depending on the position of the double_dots

**Important**: Andy Greenberg tells in a tweet that the current translation is invalid, but it should not prevent us from solving the puzzle! (Source: [tweet_1](https://twitter.com/a_greenberg/status/254604683518308352) , [tweet_2](https://twitter.com/a_greenberg/status/254604991615094784) )

Some correction on secret.csv has been made after discovering the segment-modulo deciphering, so that might have correct this alert.

# More informations

From the book website:

This Machine Kills Secrets contains a cryptographic puzzle designed by puzzlemaster G. Mark Hardy. The first three readers to solve it (not including those who had access to advance review copies, please) and email their answer to agreenberg (at) forbes (dot) com will have their name published in the paperback edition of the book and any subsequent editions.

While there are several “intermediate” answers to be found in the puzzle, winners must find the “final” answer. Solvers will know they’ve found that final answer if it closely relates to Tim May’s cat.

# Links

* Book website: http://www.thismachinekillssecrets.com/
* r/cryptography thread: http://www.reddit.com/r/cryptography/comments/111846/this_machine_kills_secrets_book_puzzle/
* Andy Greenberg twitter: http://twitter.com/a_greenberg
* G. Mark Hardy: https://twitter.com/g_mark

# Decrypting...

## Double-dot segments

```
$ ruby double_dots.rb
double-dot on page 216
code: MYENZVMYZZRYNHDW
first part: MYENZVMY
second part: ZZRYNHDW
---
double-dot on page 265
code: IHNIDOUOYUJFITCT
first part: IHNIDOUO
second part: YUJFITCT
---
section 0 (length 720): AGMZNYFPISGIHWLNDLAFVTAZESRMFHLUDKTHIESDYHPGPOCXAUHKAUSAZUDXNSUALXEDBVDJCPKMSEMLLTMXAEJFVFCWHVWGOYAVQYAWYZPOOEUHFNTVZOZXCXOALRAZTJIVFYTQXLOPYYUMHBCFDTBIYMQDXREEESIDWIOWLEIMXEGECAALIXWTONPURMRFOBNDTSCJPWJLKOOBLFSEXPCIWNHVKTAHUMMTXCZRPOIABECMMWAIRDSOVUBHTNYFNVYTXDCGSRLVPEYGSBBRNGHTLXMTESIUTQEQIFRWGMXEGSGMONJKPUZCHVUSCFTMGIUUNOXQNVTKNRLYEJSAUCUIXMSJBORATQTUIVPMZXAODMPBHOIIZXWDBVGCNOBLEJFGCTHHMSKXMRXTRNITBSJCIDAEWDVLTVECZTKUIXJSSIUFOBDHISRQKKUGWNAGRKIZYILZFCNAEATQEYNGMFHEIBHXORQSVYRFGXTMVCWHRYSQEVEDROKEPMHTJHKPADJYNEXKAJTUHUSRLHOTRBTZQXPHJMKSATIAOMHFYNCHGAESTFCIESRRPVDLINWDRMIXCVZUCECYKABEUVNUQXIEKTWSVCTNTYGYDTLSOEJJLTYKHUTGFSDNPEKEOIYBBMHAZORBDBAWWVRRUOACCTWVEKBDVIISTOTXGIQEAFXSOTYLRLTRXJTGECBMAIWFEEHXDEFDYXQLBEABMFEXFYLEQWVDKSRREVRBEULOVZQQISJKMYENZVMY
section 1 (length 160): ZZRYNHDWBNIBXEJSZAMPNOYPEXSFHYURFWHKNUBERJOHIOICNUZDILZBTSNGWIXILWONODQCHXENBVLWHVONIKYZEUSMVJDCUXSXVEIBMWCLWTKIJMMAWEXWEOILISHEQUSJHPVGDDEEVCVGMSAUMIBCIHNIDOUO
section 2 (length 232): YUJFITCTUACNCAUTSLDYYGAMMCEHGECHEXCBEEOKIZABLMHGEJBPANOTSXTHVCOUXYBGYTOXTVAIRVUSQFIHSLKXHKNZGKQGQGBLOEICESYEOXTVERNFLARHMSRBREPNURIXFNVCELAIVKFFALMUTDGKSYTRWSEFLPFOLCZVSTEODXSNJFSSULMOAGAJMQHNHNZQMEVYGCNJBEVTABADHAJEEJDCSGNGOBTQPNY
```

## Code features

72 segments of 16 chars.

Double-dots on top of Z char (page 216) and of space (page 265).

## Letter frequency

![letter frequency](https://raw.github.com/alx/this_machine_kills_secrets/master/img/letter_frequency.png)

Tool: http://www.wiley.com/college/mat/gilbert139343/java/java11_applet.html

## Longest repeated substring

```
ruby scripts/lrs.rb AGMZ...
"MXEG" (4 characters)
```

This substring is repeated twice in the entire document.

## Strange double-dots on top of 2 codes

A strange double-dots appear twice on top of the code. These dots were not included in the morse translation, but surely have a meaning.

### Page 216 code

![img/page_216.jpg](https://raw.github.com/alx/this_machine_kills_secrets/master/img/page_216.jpg)

### Page 265 code

![img/page_265.jpg](https://raw.github.com/alx/this_machine_kills_secrets/master/img/page_265.jpg)


## Complete code

Morse conversion: http://www.onlineconversion.com/morse_code.htm

```
AGMZNYFPISGIHWLNDLAFVTAZESRMFHLUDKTHIESDYHPGPOCXAUHKAUSAZUDXNSUALXEDBVDJCPKMSEMLLTMXAEJFVFCWHVWGOYAVQYAWYZPOOEUHFNTVZOZXCXOALRAZTJIVFYTQXLOPYYUMHBCFDTBIYMQDXREEESIDWIOWLEIMXEGECAALIXWTONPURMRFOBNDTSCJPWJLKOOBLFSEXPCIWNHVKTAHUMMTXCZRPOIABECMMWAIRDSOVUBHTNYFNVYTXDCGSRLVPEYGSBBRNGHTLXMTESIUTQEQIFRWGMXEGSGMONJKPUZCHVUSCFTMGIUUNOXQNVTKNRLYEJSAUCUIXMSJBORATQTUIVPMZXAODMPBHOIIZXWDBVGCNOBLEJFGCTHHMSKXMRXTRNITBSJCIDAEWDVLTVECZTKUIXJSSIUFOBDHISRQKKUGWNAGRKIZYILZFCNAEATQEYNGMFHEIBHXORQSVYRFGXTMVCWHRYSQEVEDROKEPMHTJHKPADJYNEXKAJTUHUSRLHOTRBTZQXPHJMKSATIAOMHFYNCHGAESTFCIESRRPVDLINWDRMIXCVZUCECYKABEUVNUQXIEKTWSVCTNTYGYDTLSOEJJLTYKHUTGFSDNPEKEOIYBBMHAZORBDBAWWVRRUOACCTWVEKBDVIISTOTXGIQEAFXSOTYLRLTRXJTGECBMAIWFEEHXDEFDYXQLBEABMFEXFYLEQWVDKSRREVRBEULOVZQQISJKMYENZVMYZZRYNHDWBNIBXEJSZAMPNOYPEXSFHYURFWHKNUBERJOHIOICNUZDILZBTSNGWIXILWONODQCHXENBVLWHVONIKYZEUSMVJDCUXSXVEIBMWCLWTKIJMMAWEXWEOILISHEQUSJHPVGDDEEVCVGMSAUMIBCIHNIDOUOYUJFITCTUACNCAUTSLDYYGAMMCEHGECHEXCBEEOKIZABLMHGEJBPANOTSXTHVCOUXYBGYTOXTVAIRVUSQFIHSLKXHKNZGKQGQGBLOEICESYEOXTVERNFLARHMSRBREPNURIXFNVCELAIVKFFALMUTDGKSYTRWSEFLPFOLCZVSTEODXSNJFSSULMOAGAJMQHNHNZQMEVYGCNJBEVTABADHAJEEJDCSGNGOBTQPNYI
```

## Codes by Parts

Part One:

```
AGMZNYFPISGIHWLNDLAFVTAZESRMFHLUDKTHIESDYHPGPOCXAUHKAUSAZUDXNSUALXEDBVDJCPKMSEMLLTMXAEJFVFCWHVWGOYAVQYAWYZPOOEUHFNTVZOZXCXOALRAZTJIVFYTQXLOPYYUMHBCFDTBIYMQDXREEESIDWIOWLEIMXEGECAALIXWTONPURMRF
```

Part Two:

```
OBNDTSCJPWJLKOOBLFSEXPCIWNHVKTAHUMMTXCZRPOIABECMMWAIRDSOVUBHTNYFNVYTXDCGSRLVPEYGSBBRNGHTLXMTESIUTQEQIFRWGMXEGSGMONJKPUZCHVUSCFTMGIUUNOXQNVTKNRLYEJSAUCUIXMSJBORATQTUIVPMZXAODMPBHOIIZXWDBVGCNOBLEJFGCTHHMSKXMRXTRNITBSJCIDAEWDVLTVECZTKUIXJSSIUFOBDHISRQKKUGWNAGRKIZYILZFCNAEATQEYNGMFHEIBHXORQSVYRFGXTMVCWHRYSQEVEDROKEPMHTJHKPADJYNEXKAJTUHUSRLHOTRBTZQXPHJMKSATIAOMHFYNCHGAESTFCIESRRPVDLINWDRMIXCVZUCECYKABEUVNUQXIEKTWSVCTN
```

Part Three:

```
TYGYDTLSOEJJLTYKHUTGFSDNPEKEOIYBBMHAZORBDBAWWVRRUOACCTWVEKBDVIISTOTXGIQEAFXSOTYLRLTRXJTGECBMAIWFEEHXDEFDYXQLBEABMFEXFYLEQWVDKSRREVRBEULOVZQQISJKMYENZVMYZZRYNHDWBNIBXEJSZAMPNOYPEXSFHYURFWHKNUBERJOHIOICNUZDILZBTSNGWIXILWONODQCHXENBVLWHVONIKYZEUSMVJDCUXSXVEIBMWCLWTKIJMMAWEXWEOILISHEQUSJHPVGDDEEVCVGMSAUMIBCIHNIDOUOYUJFITCTUACNCAUTSLDYYGAMMCEHGECHEXCBEEOKIZABLMHGEJBPANOTSXTHVCOUXYBGYTOXTVAIRVUSQFIHSLKXHKNZGKQGQGBLOEICESYEOXTVERNFLARHMSRBREPNURIXFNVCELAIVKFFALMUTDGKSYTRWSEFLPFOLCZVSTEODXSNJFSSULMOAGAJMQHNHNZQMEVYGCNJBEVTABADHAJEEJDCSGNGOBTQPNYI
```

## Codes by Chapters

Introduction

```
AGMZNYFPISGIHWLN
```

Chapter 1

```
DLAFVTAZESRMFHLUDKTHIESDYHPGPOCXAUHKAUSAZUDXNSUALXEDBVDJCPKMSEMLLTMXAEJFVFCWHVWGOYAVQYAWYZPOOEUHFNTVZOZXCXOALRAZTJIVFYTQXLOPYYUMHBCFDTBIYMQDXREEESIDWIOWLEIMXEGECAALIXWTONPURMRF
```

Chapter 2

```
OBNDTSCJPWJLKOOBLFSEXPCIWNHVKTAHUMMTXCZRPOIABECMMWAIRDSOVUBHTNYFNVYTXDCGSRLVPEYGSBBRNGHTLXMTESIUTQEQIFRWGMXEGSGMONJKPUZCHVUSCFTMGIUUNOXQNVTKNRLY
```

Chapter 3

```
EJSAUCUIXMSJBORATQTUIVPMZXAODMPBHOIIZXWDBVGCNOBLEJFGCTHHMSKXMRXTRNITBSJCIDAEWDVLTVECZTKUIXJSSIUFOBDHISRQKKUGWNAGRKIZYILZFCNAEATQEYNGMFHEIBHXORQS
```

Chapter 4

```
VYRFGXTMVCWHRYSQEVEDROKEPMHTJHKPADJYNEXKAJTUHUSRLHOTRBTZQXPHJMKSATIAOMHFYNCHGAESTFCIESRRPVDLINWDRMIXCVZUCECYKABEUVNUQXIEKTWSVCTN
```

Chapter 5

```
TYGYDTLSOEJJLTYKHUTGFSDNPEKEOIYBBMHAZORBDBAWWVRRUOACCTWVEKBDVIISTOTXGIQEAFXSOTYLRLTRXJTGECBMAIWFEEHXDEFDYXQLBEABMFEXFYLEQWVDKSRREVRBEULOVZQQISJKMYENZVMYZZRYNHDWBNIBXEJSZAMPNOYP
```

Chapter 6

```
EXSFHYURFWHKNUBERJOHIOICNUZDILZBTSNGWIXILWONODQCHXENBVLWHVONIKYZEUSMVJDCUXSXVEIBMWCLWTKIJMMAWEXWEOILISHEQUSJHPVGDDEEVCVGMSAUMIBCIHNIDOUOYUJFITCTUACNCAUTSLDYYGAM
```

Chapter 7

```
MCEHGECHEXCBEEOKIZABLMHGEJBPANOTSXTHVCOUXYBGYTOXTVAIRVUSQFIHSLKXHKNZGKQGQGBLOEICESYEOXTVERNFLARHMSRBREPNURIXFNVCELAIVKFFALMUTDGKSYTRWSEFLPFOLCZVSTEODXSNJFSSULMO
```

Conclusion

```
AGAJMQHNHNZQMEVYGCNJBEVTABADHAJEEJDCSGNGOBTQPNYI
```

